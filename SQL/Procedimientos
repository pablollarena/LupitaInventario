DELIMITER //
CREATE PROCEDURE insertarUsuarios(IN usuario varchar(50), IN clave varchar(200))
  BEGIN
    START TRANSACTION;
    INSERT INTO usuarios(sUsuario, sClave) VALUES(usuario, sha1(clave));
    COMMIT;
  END
//


DELIMITER //
CREATE PROCEDURE buscarTodosUsuarios()
    BEGIN
        SELECT usuarios.nIdUsuario, usuarios.sUsuario FROM usuarios;
    END
//

DELIMITER //
CREATE PROCEDURE generaReporte()
 BEGIN
     SELECT inventario.nIdInventario, software.sDescripcion, inventario.sVersion, inventario.nSerial, inventario.sRutaArchivo,
            equipos.sSt, departamento.sDepto, empleadas.sNombre
     FROM inventario
     LEFT OUTER JOIN software
     ON software.nIdSoftware = inventario.nIdSoftware
     LEFT OUTER JOIN equipos
     ON equipos.nIdEquipo = inventario.nIdEquipo
     LEFT OUTER JOIN empleadas
     ON empleadas.nIdEmpleado =  inventario.nIdEmpleado
     LEFT OUTER JOIN departamento
     ON departamento.nIdDepto = empleadas.nIdDepto;
 END

//

DELIMITER //
CREATE PROCEDURE consultaEquipos()
BEGIN
    SELECT inventario.nIdInventario, equipos.nIdEquipo,equipos.sSt FROM inventario
    LEFT OUTER JOIN equipos
    ON inventario.nIdEquipo = equipos.nIdEquipo;
END
//


select inventario.nIdInventario, equipos.nIdEquipo,equipos.sSt,departamento.sDepto from inventario
 left outer  join equipos
on  inventario.nIdEquipo = equipos.nIdEquipo
left outer join departamento
on departamento.nIdDepto = equipos.nIdDepto;


DELIMITER //
CREATE PROCEDURE `consultaEmpleadoDepto` ()
BEGIN
  SELECT inventario.nIdInventario, empleadas.nIdEmpleado,empleadas.sNombre,departamento.sDepto from inventario
  left outer join empleadas
  on inventario.nIdEmpleado = empleadas.nIdEmpleado
  left outer join departamento
  on departamento.nIdDepto = empleadas.nIdDepto;
END
//

DELIMITER //
CREATE PROCEDURE insertarEquipos(IN st varchar(30), IN depto int(11))
  BEGIN
    START TRANSACTION;
    INSERT INTO equipos(sSt, nIdDepto) VALUES(st, depto);
    COMMIT;
  END
//

DELIMITER //
CREATE PROCEDURE insertarRegistroInventario(IN software int(11), IN equipo int(11), IN version varchar(100),
                                            IN sSerial varchar(100), IN ruta varchar(200), IN empleado int(11))
  BEGIN
    START TRANSACTION;
    INSERT INTO inventario(nIdSoftware, nIdEquipo, sVersion, nSerial, sRutaArchivo, nIdEmpleado)
    VALUES(software, equipo, version, sSerial, ruta, empleado);
    COMMIT;
  END
//


DELIMITER //
CREATE PROCEDURE insertarSoftware(IN descripcion varchar(100))
  BEGIN
    START TRANSACTION;
    INSERT INTO software(sDescripcion) VALUES(descripcion);
    COMMIT;
  END
//

DELIMITER //
CREATE PROCEDURE buscarCvePass(IN usuario varchar(50), IN pass varchar(100))
  BEGIN
    SELECT usuarios.sUsuario FROM usuarios
    WHERE usuarios.sUsuario = usuario AND usuarios.sClave = sha1(pass);
  END
//


INSERT INTO departamento(sDepto) VALUES('TRAFICO');


INSERT INTO software(sDescripcion) VALUES('Microsoft Windows 10');
INSERT INTO equipos(sSt, nIdDepto) VALUES('AXJAJSJ1',1);
INSERT INTO equipos(sSt, nIdDepto) VALUES('HSH1HH12',1);

INSERT INTO empleadas(sNombre, nIdDepto) VALUES('Lupita Yañez', 1);
INSERT INTO empleadas(sNombre, nIdDepto) VALUES('Gaby Chang', 1);

call insertarUsuarios('pllarena','pllarena');

INSERT INTO inventario(nIdSoftware, nIdEquipo, sVersion, nSerial, sRutaArchivo, nIdEmpleado)
VALUES(1,1,'Versión','212321321331','ruta',1);

UPDATE inventario
SET nIdEmpleado = 1
WHERE nIdInventario = 1;